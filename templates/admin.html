{% extends "base.html" %}

{% block title %}–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å - –ú–µ–Ω–µ–¥–∂–µ—Ä –ø–∞—Ä–æ–ª–µ–π{% endblock %}

{% block content %}
<div class="dashboard">
    <h2>üîê –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–Ω–µ–ª—å</h2>
    <p style="color: #666; margin-bottom: 30px;">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä <strong>{{ username }}</strong></p>
    
    <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
    <div class="admin-stats">
        <div class="stat-card">
            <h3>üë• –í—Å–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</h3>
            <p class="stat-number">{{ users|length }}</p>
        </div>
        <div class="stat-card">
            <h3>üîë –í—Å–µ–≥–æ –ø–∞—Ä–æ–ª–µ–π</h3>
            <p class="stat-number">{{ all_passwords|length }}</p>
        </div>
    </div>
    
    <!-- –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π -->
    <div class="admin-section">
        <h3>üë• –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</h3>
        <div class="users-list">
            {% for user in users %}
            <div class="user-item">
                <span class="user-icon">üë§</span>
                <span class="user-name">{{ user }}</span>
                {% if user == 'admin' %}
                <span class="admin-badge">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</span>
                {% endif %}
            </div>
            {% endfor %}
        </div>
    </div>
    
    <!-- –¢–∞–±–ª–∏—Ü–∞ –≤—Å–µ—Ö –ø–∞—Ä–æ–ª–µ–π -->
    <div class="admin-section">
        <h3>üîë –í—Å–µ –ø–∞—Ä–æ–ª–∏ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</h3>
        
        {% if all_passwords %}
        <div class="passwords-table">
            <table>
                <thead>
                    <tr>
                        <th>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</th>
                        <th>–°–µ—Ä–≤–∏—Å</th>
                        <th>–ü–∞—Ä–æ–ª—å</th>
                        <th>–î–ª–∏–Ω–∞</th>
                        <th>–°–ª–æ–∂–Ω–æ—Å—Ç—å</th>
                        <th>–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è</th>
                    </tr>
                </thead>
                <tbody>
                    {% for pwd in all_passwords %}
                    <tr>
                        <td><strong>{{ pwd.username }}</strong></td>
                        <td>{{ pwd.service }}</td>
                        <td class="password-cell">
                            <span class="password-hidden">‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢</span>
                            <span class="password-visible" style="display: none;">{{ pwd.password }}</span>
                            <button class="btn-toggle" onclick="togglePassword(this)">üëÅÔ∏è</button>
                            <button class="btn-copy" onclick="copyPassword('{{ pwd.password }}')">üìã</button>
                        </td>
                        <td>{{ pwd.length }}</td>
                        <td>{{ pwd.complexity }}</td>
                        <td>{{ pwd.timestamp }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% else %}
        <p class="no-passwords">–ü–æ–∫–∞ –Ω–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –ø–∞—Ä–æ–ª–µ–π –≤ —Å–∏—Å—Ç–µ–º–µ</p>
        {% endif %}
    </div>
    
    <div style="margin-top: 30px;">
        <a href="{{ url_for('dashboard') }}" class="btn btn-primary" style="width: auto;">‚Üê –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –º–æ–∏–º –ø–∞—Ä–æ–ª—è–º</a>
    </div>
</div>

<script>
function togglePassword(button) {
    const cell = button.parentElement;
    const hidden = cell.querySelector('.password-hidden');
    const visible = cell.querySelector('.password-visible');
    
    if (hidden.style.display === 'none') {
        hidden.style.display = 'inline';
        visible.style.display = 'none';
        button.textContent = 'üëÅÔ∏è';
    } else {
        hidden.style.display = 'none';
        visible.style.display = 'inline';
        button.textContent = 'üôà';
    }
}

function copyPassword(password) {
    navigator.clipboard.writeText(password).then(() => {
        alert('–ü–∞—Ä–æ–ª—å —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞!');
    });
}
</script>
{% endblock %}
